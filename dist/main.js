!function(t){var e={};function i(s){if(e[s])return e[s].exports;var o=e[s]={i:s,l:!1,exports:{}};return t[s].call(o.exports,o,o.exports,i),o.l=!0,o.exports}i.m=t,i.c=e,i.d=function(t,e,s){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)i.d(s,o,function(e){return t[e]}.bind(null,o));return s},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=0)}([function(t,e,i){"use strict";function s(t,e,...i){const s=document.createElement(t);return Object.keys(e).forEach(t=>{t.startsWith("data-")?s.setAttribute(t,e[t]):s[t]=e[t]}),i.forEach(t=>{"string"==typeof t&&(t=document.createTextNode(t)),s.appendChild(t)}),s}i.r(e);class o{constructor(){this.events={}}on(t,e){this.events[t]=this.events[t]||[],this.events[t].push(e)}emit(t,e){this.events[t]&&this.events[t].forEach(t=>t(e))}}var n=class extends o{constructor(){super(),this.form=document.getElementById("todo-form"),this.input=document.getElementById("add-input"),this.list=document.getElementById("todo-list"),this.form.addEventListener("submit",this.handleAdd.bind(this))}createListItem(t){const e=s("input",{type:"checkbox",className:"checkbox",checked:t.completed?"checked":""}),i=s("label",{className:"title"},t.title),o=s("input",{type:"text",className:"textfield"}),n=s("button",{className:"edit"},"Изменить"),d=s("button",{className:"remove"},"Удалить"),r=s("li",{className:`todo-item${t.completed?" completed":""}`,"data-id":t.id},e,i,o,n,d);return this.addEventListeners(r)}addEventListeners(t){const e=t.querySelector(".checkbox"),i=t.querySelector("button.edit"),s=t.querySelector("button.remove");return e.addEventListener("change",this.handleToggle.bind(this)),i.addEventListener("click",this.handleEdit.bind(this)),s.addEventListener("click",this.handleRemove.bind(this)),t}findListItem(t){return this.list.querySelector(`[data-id="${t}"]`)}handleAdd(t){if(t.preventDefault(),!this.input.value)return alert("Необходимо ввести название задачи.");const e=this.input.value;this.emit("add",e)}handleToggle({target:t}){const e=t.parentNode.getAttribute("data-id"),i=t.checked;this.emit("toggle",{id:e,completed:i})}handleEdit({target:t}){const e=t.parentNode,i=e.getAttribute("data-id"),s=e.querySelector(".title"),o=e.querySelector(".textfield"),n=e.querySelector("button.edit"),d=o.value;e.classList.contains("editing")?this.emit("edit",{id:i,title:d}):(o.value=s.textContent,n.textContent="Сохранить",e.classList.add("editing"))}handleRemove({target:t}){const e=t.parentNode;this.emit("remove",e.getAttribute("data-id"))}show(t){t.forEach(t=>{const e=this.createListItem(t);this.list.appendChild(e)})}addItem(t){const e=this.createListItem(t);this.input.value="",this.list.appendChild(e)}toggleItem(t){const e=this.findListItem(t.id);e.querySelector(".checkbox").checked=t.completed,t.completed?e.classList.add("completed"):e.classList.remove("completed")}editItem(t){const e=this.findListItem(t.id),i=e.querySelector(".title"),s=(e.querySelector(".textfield"),e.querySelector("button.edit"));i.textContent=t.title,s.textContent="Изменить",e.classList.remove("editing")}removeItem(t){const e=this.findListItem(t);this.list.removeChild(e)}};var d=class{constructor(t,e){this.model=t,this.view=e,e.on("add",this.addTodo.bind(this)),e.on("toggle",this.toggleTodo.bind(this)),e.on("edit",this.editTodo.bind(this)),e.on("remove",this.removeTodo.bind(this)),e.show(t.items)}addTodo(t){const e=this.model.addItem({id:Date.now(),title:t,completed:!1});this.view.addItem(e)}toggleTodo({id:t,completed:e}){const i=this.model.updateItem(t,{completed:e});this.view.toggleItem(i)}editTodo({id:t,title:e}){const i=this.model.updateItem(t,{title:e});this.view.editItem(i)}removeTodo(t){this.model.removeItem(t),this.view.removeItem(t)}};const r=new class extends o{constructor(t=[]){super(),this.items=t}getItem(t){return this.items.find(e=>e.id==t)}addItem(t){return this.items.push(t),this.emit("change",this.items),t}updateItem(t,e){const i=this.getItem(t);return Object.keys(e).forEach(t=>i[t]=e[t]),this.emit("change",this.items),i}removeItem(t){const e=this.items.findIndex(e=>e.id==t);e>-1&&(this.items.splice(e,1),this.emit("change",this.items))}}(function(){const t=localStorage.getItem("todos");return JSON.parse(t)}()||void 0);r.on("change",t=>(function(t){const e=JSON.stringify(t);localStorage.setItem("todos",e)})(t));new d(r,new n)}]);